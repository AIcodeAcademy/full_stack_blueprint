---
description: Generate a server repository module
globs: /src/server/api/**/*.repository.ts
alwaysApply: false
---
---
description: Generate a server repository module
globs: /src/server/api/**/*.repository.ts
alwaysApply: false
---
This rule is for generating or updating server repository modules.

- Work at the `/src/server/api/resource-name` folder
- Create file with `{{resource-name}}.repository.ts` 
  - Import dependencies:
    - Entities definition from `/src/server/domain` folder
    - SQL utils from `/src/server/shared/sql.utils.ts` file
    - SQL type utils form `/src/server/shared/sql.type.ts` file
  - Define and export functions that interact with database
    - Named in `camelCase` with SQL friendly names like `selectUser` or `insertUser`
    - Parameters can be primitives, or partial entities
    - Responses are always an entity, an array of entities or a number of affected rows
  - If needed call the validation function `validateEntityName(entity: EntityName)` 
- Study `tools.repository.json` as a reference implementation